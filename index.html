<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css"
    />
  </head>

  <script>
    function padTo2Digits(num) {
      return num.toString().padStart(2, '0');
    }

    // function convertMsToHM(milliseconds) {
    //   let seconds = Math.floor(milliseconds / 1000);
    //   let minutes = Math.floor(seconds / 60);
    //   let hours = Math.floor(minutes / 60);

    //   seconds = seconds % 60;
    //   // 👇️ if seconds are greater than 30, round minutes up (optional)
    //   minutes = seconds >= 30 ? minutes + 1 : minutes;

    //   minutes = minutes % 60;

    //   // 👇️ If you don't want to roll hours over, e.g. 24 to 00
    //   // 👇️ comment (or remove) the line below
    //   // commenting next line gets you `24:00:00` instead of `00:00:00`
    //   // or `36:15:31` instead of `12:15:31`, etc.
    //   hours = hours % 24;

    //   return `${padTo2Digits(hours)}:${padTo2Digits(minutes)}:${padTo2Digits(
    //     seconds,
    //   )}`;
    // }

    var myHeaders = new Headers();
    myHeaders.append('Content-Type', 'application/json');

    let date = new Date();

    let dateString = `${date.getFullYear()}-${padTo2Digits(
      date.getMonth() + 1,
    )}-${padTo2Digits(date.getDate())}`;

    var raw = JSON.stringify({
      from_date: dateString,
      to_date: dateString,
    });

    var requestOptions = {
      method: 'POST',
      headers: myHeaders,
      body: raw,
      redirect: 'follow',
    };
    var data;
    const getData = async () => {
      data = await fetch(
        'http://api.blue-ex.com:5003/attendance-app/attendance/getattendancedata',
        requestOptions,
      )
        .then((response) => response.json())
        .then((result) => {
          return result;
        })
        .catch((error) => console.log('error', error));
      console.log(data);

      let tbody = document.querySelector('tbody');
      tbody.innerHTML = '';
      data.map(
        (item) =>
          (tbody.innerHTML += `
                 <tr>
                    <td>${item.employee_number}</td>
                    <td>${item.employee_name}</td>
                    <td>${item.attendance_date}</td>
                    <td>${item.intime}</td>
                    <td>${item.outtime}</td>
                    <td>${item.working_hours}</td>
                    <td>${item.type}</td>
                </tr>
        `),
      );
    };

    getData();
  </script>

  <body>
    <!-- Sidebar -->
    <div
      class="w3-sidebar w3-light-grey w3-bar-block sidebar"
      style="width: 20%; z-index: 4; padding-top: 2rem"
    >
      <img
        src="images/blue_ex.svg"
        style="height: 1.9rem; padding-left: 1rem"
      />
      <hr />
      <h3 class="w3-bar-item">Dashboard</h3>
      <a href="index.html" class="w3-bar-item w3-button">Attendance</a>
      <a href="form.html" class="w3-bar-item w3-button">Add Attendance</a>
    </div>

    <div class="header">
      <img src="images/avatar.png" alt="" />
      <div>
        <h3>Urooj Majid</h3>
        <p>SuperAdmin</p>
      </div>
    </div>
    <div style="visibility: hidden">
      <h3>Dashboard</h3>

      <p>Attendance</p>
    </div>
    <div style="margin-left: 20%; z-index: 2">
      <table
        id="example"
        class="table table-striped table-bordered"
        style="width: 100%"
      >
        <thead>
          <tr>
            <th>EMPOLYEE#</th>
            <th>EMPOLYEE Name</th>
            <th>Attendance date</th>
            <th>In Time</th>
            <th>Out Time</th>
            <th>Workin Hours</th>
            <th>Attendance Type</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <!-- <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap4.min.js"></script> -->
    <script src="app.js"></script>
  </body>
</html>
